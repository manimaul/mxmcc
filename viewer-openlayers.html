<!DOCTYPE html>
<html>
<head>
    <title>OpenLayers Viewer</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no"/>
    <script src="http://maps.google.com/maps/api/js?v=3&amp;sensor=false"></script>
    <script src="http://www.openlayers.org/api/OpenLayers.js"></script>
    <script src="viewer.js"></script>
    <script>
        var metadata = read_metadata();
        var map, layer;
        var bounds = metadata.bounds.split(',')
        var mapBounds = new OpenLayers.Bounds(bounds[0], bounds[1], //west, south, east, north
                                              bounds[2], bounds[3]);
        var mapMinZoom = metadata.minzoom;
        var mapMaxZoom = metadata.maxzoom;

        function init() {
            var options = {
                projection: "EPSG:3857",
                displayProjection: "EPSG:4326",
                numZoomLevels: 18
            };
            map = new OpenLayers.Map('map', options);
            var loc = window.location.pathname;
            var dir = loc.substring(0, loc.lastIndexOf('/'));
            layer = new OpenLayers.Layer.XYZ("Tileserver",
                        window.location.protocol + '//' + window.location.host + '/' + dir + '/${z}/${x}/${y}.png', {
                        transitionEffect: 'resize',
                        isBaseLayer: false
                    });
            var osm = new OpenLayers.Layer.OSM();
            var gmap = new OpenLayers.Layer.Google(
                    "Google Streets", {numZoomLevels: 20}
            );
            var ghyb = new OpenLayers.Layer.Google(
                    "Google Hybrid",
                    {type: google.maps.MapTypeId.HYBRID, numZoomLevels: 20}
            );
            var gsat = new OpenLayers.Layer.Google(
                    "Google Satellite",
                    {type: google.maps.MapTypeId.SATELLITE, numZoomLevels: 22}
            );
            var gphy = new OpenLayers.Layer.Google(
                    "Google Physical",
                    {type: google.maps.MapTypeId.TERRAIN}
            );
            map.addLayers([
                layer, osm, gmap, gsat, ghyb, gphy
            ]);
            map.zoomToExtent(mapBounds.transform(map.displayProjection, map.projection));
            map.addControl(new OpenLayers.Control.MousePosition());
            map.addControl(new OpenLayers.Control.Permalink());
            map.addControl(new OpenLayers.Control.LayerSwitcher());
        }
    </script>
    <style>
        html, body, #map {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }

        .olImageLoadError {
            display: none !important;
        }

        .olControlAttribution {
            bottom: 0px !important;
            left: 2px;
            right: inherit;
            width: 400px;
        }
    </style>
</head>
<body onload="init()">
<div id="map"></div>
</body>
</html>
